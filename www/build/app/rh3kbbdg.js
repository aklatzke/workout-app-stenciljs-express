/*! Built with http://stenciljs.com */
const{h:t}=window.App;import{a as e}from"./chunk-27ccbbe9.js";import{a as i,b as o}from"./chunk-304dc430.js";class a{componentWillLoad(){this.interval=setInterval(()=>{let t=e.duration(e().utc().diff(e(this.activeWorkout.date)));this.timer=e.utc(t.asMilliseconds()).format("HH:mm:ss")},1e3)}componentWillUnload(){clearInterval(this.interval)}render(){return t("stencil-route-link",{url:"/workout/active"},t("div",{class:"active-workout-bar"},t("div",{class:"row"},t("div",{class:"col-7 text-center"},"Active Routine: ",t("strong",null,this.activeWorkout.name)),t("div",{class:"col-5 text-center timer"},this.timer))))}static get is(){return"active-workout-bar"}static get properties(){return{activeWorkout:{type:"Any",attr:"active-workout"},timer:{state:!0}}}static get style(){return".active-workout-bar{position:fixed;bottom:0;left:0;right:0;background-color:#fff;padding-top:15px;padding-bottom:15px;font-size:14px;border-top:2px solid #000;color:#444}.timer{color:#51cbce;font-weight:700}"}}window.firebase||(window.firebase={},window.firebase.auth=(()=>({onAuthStateChanged:()=>{},signInWithRedirect:()=>{}})),window.firebase.auth.GoogleAuthProvider=(()=>{}));class r{constructor(){this.componentDidLoad=(()=>{window.firebase.auth().onAuthStateChanged(t=>{if(t){let{email:e,displayName:i,uid:o}=t;this.authenticationResponse.emit({email:e,displayName:i,uid:o})}else window.firebase.auth().signInWithRedirect(new window.firebase.auth.GoogleAuthProvider)})})}render(){return null}static get is(){return"app-authentication"}static get events(){return[{name:"authenticationResponse",method:"authenticationResponse",bubbles:!0,cancelable:!0,composed:!0}]}static get style(){return".app-home{padding:10px}button{background:#5851ff;color:#fff;margin:8px;border:none;font-size:13px;font-weight:700;text-transform:uppercase;padding:16px 20px;border-radius:2px;-webkit-box-shadow:0 8px 16px rgba(0,0,0,.1),0 3px 6px rgba(0,0,0,.08);box-shadow:0 8px 16px rgba(0,0,0,.1),0 3px 6px rgba(0,0,0,.08);outline:0;letter-spacing:.04em;-webkit-transition:all .15s ease;transition:all .15s ease;cursor:pointer}button:hover{-webkit-box-shadow:0 3px 6px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.1);box-shadow:0 3px 6px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.1);-webkit-transform:translateY(1px);transform:translateY(1px)}"}}var n=function(t,e,i,o){return new(i||(i=Promise))(function(a,r){function n(t){try{c(o.next(t))}catch(t){r(t)}}function s(t){try{c(o.throw(t))}catch(t){r(t)}}function c(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(n,s)}c((o=o.apply(t,e||[])).next())})};class s{constructor(){this.isAuthenticated=!1,this.hasActiveWorkout=!1}handleAuthentication(t){return n(this,void 0,void 0,function*(){if(t.detail){let e=Object.assign({},t.detail);this.isAuthenticated=!0;let a=yield o("http://localhost:8080/user/findOrCreate",e);this.activeUser=a,this.activeWorkout=yield i(`http://localhost:8080/user/${this.activeUser._id}/workout/active`),this.activeWorkout&&(this.hasActiveWorkout=!0)}})}setContextMenu(t){this.contextMenu=t.detail}maybeRenderActiveBar(){if(this.hasActiveWorkout)return t("active-workout-bar",{activeWorkout:this.activeWorkout})}changeBack(t){return n(this,void 0,void 0,function*(){t.detail?this.backUrl=t.detail:this.backUrl=""})}activeWorkoutChange(){return n(this,void 0,void 0,function*(){this.activeWorkout=yield i(`http://localhost:8080/user/${this.activeUser._id}/workout/active`),this.activeWorkout?this.hasActiveWorkout=!0:this.hasActiveWorkout=!1})}renderApp(){return t("main",null,t("stencil-router",null,t("stencil-route-switch",{scrollTopOffset:0},t("stencil-route",{url:"/",component:"workouts-dashboard",exact:!0,componentProps:{uid:this.activeUser._id,hasActiveWorkout:this.hasActiveWorkout}}),t("stencil-route",{url:"/profile/:name",component:"app-profile"}),t("stencil-route",{url:"/exercise/:eid",component:"exercise-specific",exact:!0,componentProps:{uid:this.activeUser._id}}),t("stencil-route",{url:"/workout/new",component:"new-workout",exact:!0,componentProps:{uid:this.activeUser._id}}),t("stencil-route",{url:"/workout/active",component:"active-workout",exact:!0,componentProps:{uid:this.activeUser._id}}),this.hasActiveWorkout?t("stencil-route",{url:"/workout/active/add",component:"add-exercise",exact:!0,componentProps:{uid:this.activeUser._id,activeWorkout:this.activeWorkout._id}}):null)))}maybeRenderBack(){if(this.backUrl)return t("stencil-route-link",{url:this.backUrl},t("button",{class:"btn btn-outline-default btn-sm"},t("small",null,t("i",{class:"fa fa-chevron-left"}))," Back"))}maybeRenderLogin(){return this.isAuthenticated?this.renderApp():t("app-authentication",null)}render(){return t("div",null,t("header",{class:"navbar"},t("div",{class:"col-4 header-right text-center"},this.maybeRenderBack()),t("div",{class:"col-4 text-center"},t("h1",{class:"navbar-brand text-center"},"Tracker")),t("div",{class:"col-4 header-right text-center"},t("span",null,this.contextMenu))),this.maybeRenderLogin(),this.maybeRenderActiveBar())}static get is(){return"app-root"}static get properties(){return{activeUser:{state:!0},activeWorkout:{state:!0},backUrl:{state:!0},contextMenu:{state:!0},hasActiveWorkout:{state:!0}}}static get listeners(){return[{name:"authenticationResponse",method:"handleAuthentication"},{name:"setContextMenu",method:"setContextMenu"},{name:"changeBack",method:"changeBack"},{name:"activeWorkoutChange",method:"activeWorkoutChange"}]}static get style(){return"header{background:#5851ff;color:#fff;height:56px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);box-shadow:0 2px 5px 0 rgba(0,0,0,.26)}h1{font-size:2rem;font-weight:500;color:#fff;padding:0 12px}.header-right span{color:#333;font-size:12px}.navbar h1.navbar-brand{font-size:14px}"}}export{a as ActiveWorkoutBar,r as AppAuthentication,s as AppRoot};